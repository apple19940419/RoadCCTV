<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RoadCCTV v2</title>
<style>
  body { font-family: sans-serif; text-align: center; }
  #map { width: 100%; height: 400px; margin-bottom: 1rem; }
  iframe { width: 480px; height: 270px; margin: 8px; border: none; }
</style>
</head>
<body>
  <h1>RoadCCTV 台北路口即時影像 Demo</h1>
  <div id="map"></div>
  <div id="videos"></div>

  <script>
  const map = new google.maps.Map(document.getElementById("map"), {
    center: { lat: 25.033964, lng: 121.564468 },
    zoom: 13,
  });

  fetch(`/api/nearby-cameras?lat=25.0339&lng=121.5644`)
    .then(res => res.json())
    .then(cams => {
      const videosDiv = document.getElementById("videos");
      cams.forEach(c => {
        new google.maps.Marker({
          position: { lat: c.lat, lng: c.lng },
          map,
          title: c.name
        });
        const iframe = document.createElement("iframe");
        iframe.src = c.snapshot_url;
        iframe.title = c.name;
        videosDiv.appendChild(iframe);
      });
    });
  </script>
  <script async
    src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=()=>{}">
  </script>
</body>
</html>